#include <cassert>
#include <cstdio>
#include <set>
#include "tokens.h"

extern int sym;
extern int lineno, colno;

extern char *tokstart;
extern int toklen;

extern "C" void getsym();

static bool expect(int s, std::set<int> &&t, std::set<int> &&f)
{
	if (sym == s) {
		getsym();
		return true;
	}
	fprintf(stderr, "%d:%d: syntax error at ‘%.*s’\n",
		lineno, colno, toklen, tokstart);
	for (;;) {
		if (t.count(sym)) return true;
		if (f.count(sym)) return false;
		fprintf(stderr, "%d:%d: [skipping ‘%.*s’]\n",
			lineno, colno, toklen, tokstart);
		getsym();
	}
}

static std::set<int> set_union(const std::set<int> &a, const std::set<int> &b)
{
	std::set<int> u(b);
	u.insert(a.begin(), a.end());
	return u;
}
